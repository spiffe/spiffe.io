{{ $docsHome   := .CurrentSection }}
{{ $allDocs    := site.Pages  }}

{{ $spiffeAbout        := where $allDocs ".Params.kind" "eq" "spiffe-about" }}

{{ $spireAbout         := where $allDocs ".Params.kind" "eq" "spire-about" }}

{{ $spireHelmChartsHardenedAbout         := where $allDocs ".Params.kind" "eq" "spire-helm-charts-hardened-about" }}
{{ $spireHelmChartsHardenedAdvanced := where $allDocs ".Params.kind" "eq" "spire-helm-charts-hardened-advanced" }}

{{ $spirePlanning      := where $allDocs ".Params.kind" "eq" "planning" }}
{{ $spireTry           := where $allDocs ".Params.kind" "eq" "try" }}  
{{ $spireDeploying     := where $allDocs ".Params.kind" "eq" "deploying" }}
{{ $spireMaintenance   := where $allDocs ".Params.kind" "eq" "maintenance" }}

{{ $spireArchitecture  := where $allDocs ".Params.kind" "eq" "architecture" }}
{{ $spireMicroservices := where $allDocs ".Params.kind" "eq" "microservices" }}
{{ $spireKeyless       := where $allDocs ".Params.kind" "eq" "keyless" }}

{{ $pageUrl    := .URL }}
{{ $isDocsHome := eq .URL $docsHome.URL }}
{{ $version    := index (split .File.Path "/") 1 }}
{{/* $latest     := index site.Data.releases 1 */}}
{{/* $latest     := "v0.10.0" */}}

{{/*}}
{{ $docsHomeVersion := $version }}
{{ if or (eq $version $latest) }}
{{ $docsHomeVersion = "latest" }}
{{ end }}
<a class="docs-nav-item{{ if $isDocsHome }} is-active{{ end }}" href="/docs/{{ $docsHomeVersion }}">
  {{ $docsHome.Name }}
</a>

{{ if $isDocsHome }}
<div class="toc">
  {{ .TableOfContents }}
</div>
{{ end }}

{{ range $aboutSpire }}
  {{- partial "docs/sidenav-link.html" (dict "ctx" . "pageUrl" $pageUrl "version" $version) -}}
{{ end }}
{{*/}}

<span class="docs-nav-section">
  SPIFFE
</span>
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spiffeAbout "pageUrl" $pageUrl "version" $version ) }}

<span class="docs-nav-section">
  SPIRE
</span>
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireAbout "pageUrl" $pageUrl "version" $version ) }}
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireTry "pageUrl" $pageUrl "version" $version ) }}
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spirePlanning "pageUrl" $pageUrl "version" $version ) }}
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireDeploying "pageUrl" $pageUrl "version" $version ) }}
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireMaintenance "pageUrl" $pageUrl "version" $version ) }}

<span class="docs-nav-section">
  Helm Charts Hardened
</span>
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireHelmChartsHardenedAbout "pageUrl" $pageUrl "version" $version ) }}
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireHelmChartsHardenedAdvanced "pageUrl" $pageUrl "version" $version ) }}

<span class="docs-nav-section">
  Integrate SPIRE
</span>
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireMicroservices "pageUrl" $pageUrl "version" $version ) }}
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireKeyless "pageUrl" $pageUrl "version" $version ) }}
{{ partial "docs/sidenav-section.html" ( dict "ctx" . "section" $spireArchitecture "pageUrl" $pageUrl "version" $version ) }}

